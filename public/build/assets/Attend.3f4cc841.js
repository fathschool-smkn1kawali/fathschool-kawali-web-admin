import{_ as C}from"./AppLayout.f7869522.js";import{T as D}from"./ToolTip.e1c056c0.js";import{P as E}from"./Pagination.141e6051.js";import{_ as I,I as m,N,u as F,o as _,c as L,w as d,a,b as o,t as i,C as B,g as p,e as y,F as U,i as P,j as R,s as k,V as w,r as c,n as T}from"./app.eb4bca63.js";import{P as O}from"./PieChart.a9afc558.js";import{_ as z}from"./Modal.d8e7dcb9.js";import{s as q}from"./multiselect.bd328a4e.js";/* empty css                                                         */import{r as H}from"./TrashIcon.e473cb8e.js";import{r as G}from"./PencilSquareIcon.8a68b151.js";import{r as J}from"./EyeIcon.9c22218b.js";import{r as K}from"./ArrowRightIcon.9bf26196.js";import"./TopBarMenu.57ba7e85.js";import"./CheckCircleIcon.c15b336b.js";import"./shepherd.esm.28e46ee4.js";import"./XMarkIcon.c835eea2.js";import"./WarningToast.ca887990.js";import"./NavLink.88c501bd.js";import"./PlusCircleIcon.b3c660e0.js";import"./UserIcon.11494925.js";import"./Bars3Icon.9d3eeab9.js";import"./auto.4bbfcea2.js";const Q={components:{AppLayout:C,ToolTip:D,TrashIcon:H,PencilSquareIcon:G,Pagination:E,EyeIcon:J,ArrowRightIcon:K,dayjs:m,PieChart:O,ExportModal:z,Multiselect:q,NothingFound:N},props:{courses:Array,subjects:Array,students:Array,filter_data:Object,attendances:Object},data(){var e,r,l,u,t;return{filter:F({course_id:(e=this.filter_data.course_id)!=null?e:"",subject_id:(r=this.filter_data.subject_id)!=null?r:"",student_id:(l=this.filter_data.student_id)!=null?l:"",month:(u=this.filter_data.month)!=null?u:"",year:(t=this.filter_data.year)!=null?t:""}),customDateFormat:"YYYY-MM-DD",customMonthFormat:"YYYY-MM",month_value:this.filter_data.month?m(m(this.filter_data.month).format("MMM")+this.filter_data.year,this.customMonthFormat):null,subjects:this.subjects,students:this.students,selected_month:this.filter_data.month,selected_year:this.filter_data.year,visible:!1,loading:!1,export_data:{type:"xlsx",student:"",month:"",year:"",subject:"",course:""}}},watch:{month_value:function(e){e?(this.filter.month=m(e).format("MM"),this.filter.year=m(e).format("YYYY")):(this.filter.month=null,this.filter.year=null)},"filter.course_id":function(e,r){e&&this.filterData()}},methods:{filterData(){this.filter.get(this.route("report.attendance"))},showExportModal(){this.visible=!0},exportSubmit(){this.loading=!0,this.export_data.student=this.filter.student_id,this.export_data.year=this.filter.year,this.export_data.month=this.filter.month,this.export_data.subject=this.filter.subject,this.export_data.course=this.filter.course,axios({url:this.route("report.attendance.export"),method:"POST",data:this.export_data,responseType:"blob"}).then(e=>{this.export_data.type;var r=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=r;const u=e.headers["content-disposition"],t=u.indexOf('"')+1,n=u.lastIndexOf('"'),b=u.substring(t,n);l.setAttribute("download",b),document.body.appendChild(l),l.click(),this.loading=!1,this.visible=!1}).catch(e=>{this.loading=!1,this.visible=!1})},attendanceStatus(e,r){const l=e<10?`0${e}`:e,u=`${this.selected_year}-${this.selected_month}-${l}`;let t=null;return this.attendances.forEach(n=>{n.date==u&&(t=n.status)}),t},getMonthName(e){return m(`${this.selected_year}-${e}`).format("MMMM")}},computed:{daysInMonth(){return this.selected_year==""||this.selected_month==""?!1:m(`${this.selected_year}-${this.selected_month}`).daysInMonth()}},mounted(){}},W={class:"py-12"},X={class:"mb-3 rounded-lg py-4 font-semibold text-left rtl:text-right text-gray-900 bg-white dark:text-white dark:bg-gray-800"},Z={class:"dark:text-gray-400 mb-0 text-2xl"},$={class:"col-span-2"},ee={class:"col-span-2"},te={class:"col-span-2"},se={class:"col-span-2"},oe={class:"flex gap-3"},re={class:"col-span-1"},ae={key:0},le={class:"bg-white dark:bg-gray-800 rounded-sm"},ne={class:"flex justify-between items-center"},ie={class:"mb-0 text-black/[0.85] dark:text-gray-400 font-semibold text-base px-6 py-4"},de={class:"mr-1"},ce=o("hr",{class:"dark:border-gray-600"},null,-1),ue={class:"grid grid-cols-8 gap-3 p-4"},me={class:"mb-1 text-xl font-medium mt-6"},fe={class:"text-md capitalize"},pe={key:1,class:"text-center mt-52"},he=o("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[o("path",{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})],-1),_e={class:"mt-2 text-sm font-medium text-gray-900"},be={class:"mt-1 text-sm text-gray-500"},ge={class:"flex gap-6"},ye={class:"w-full rounded-lg cursor-pointer flex items-center pl-4 border border-gray-200 dark:border-gray-700"},xe={for:"pdf",class:"w-full cursor-pointer rounded-lg flex items-center pl-4 border border-gray-200 dark:border-gray-700"};function ve(e,r,l,u,t,n){const b=c("BreadcrumbLink"),M=c("Breadcrumb"),j=c("page-header"),f=c("global-label"),x=c("Multiselect"),S=c("a-date-picker"),g=c("global-button"),V=c("NothingFound"),Y=c("export-modal"),A=c("AppLayout");return _(),L(A,{title:e.__("Attendance Report")},{default:d(()=>[a(M,null,{default:d(()=>[a(b,{href:e.route("reports.index"),title:"Report"},null,8,["href"]),a(b,{title:e.__("Attendance List")},null,8,["title"])]),_:1}),o("div",W,[o("div",X,[a(j,{class:"flex justify-between items-center"},{default:d(()=>[o("div",null,[o("h1",Z,i(e.__("Student Attendance")),1)])]),_:1}),o("form",{class:"grid grid-cols-1 md:grid-cols-9 gap-2 items-center px-6",onSubmit:r[4]||(r[4]=B(s=>n.filterData(),["prevent"]))},[o("div",$,[a(f,{for:"class",value:"Course"}),a(x,{id:"class",class:"dark:text-gray-900",modelValue:t.filter.course_id,"onUpdate:modelValue":r[0]||(r[0]=s=>t.filter.course_id=s),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Course"),options:l.courses.map(s=>({value:s.id,label:s.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),o("div",ee,[a(f,{for:"subject",value:"Subject"}),a(x,{id:"subject",class:"dark:text-gray-900",modelValue:t.filter.subject_id,"onUpdate:modelValue":r[1]||(r[1]=s=>t.filter.subject_id=s),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Subjects"),options:t.subjects.map(s=>({value:s.id,label:s.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),o("div",te,[a(f,{for:"student",value:"Student"}),a(x,{id:"student",class:"dark:text-gray-900",modelValue:t.filter.student_id,"onUpdate:modelValue":r[2]||(r[2]=s=>t.filter.student_id=s),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Student"),options:t.students.map(s=>({value:s.id,label:s.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),o("div",se,[a(f,{for:"month",value:"Month"}),o("div",oe,[a(S,{size:"large",placeholder:e.__("Select Month"),picker:"month",value:t.month_value,"onUpdate:value":r[3]||(r[3]=s=>t.month_value=s),format:"MMM YYYY",style:{width:"400px"}},null,8,["placeholder","value"])])]),o("div",re,[a(g,{loading:t.filter.processing,class:"text-white mt-6 bg-blue-500 dark:bg-blue-500 hover:bg-blue-500 active:bg-blue-600 dark:active:bg-blue-600 focus:border-blue-600 dark:focus:border-blue-600 focus:ring focus:ring-blue-300 dark:focus:ring-blue-300"},{default:d(()=>[p(i(e.__("Apply Filter")),1)]),_:1},8,["loading"])])],32)]),l.attendances.length&&t.selected_month&&t.selected_year?(_(),y("div",ae,[o("div",le,[o("div",ne,[o("h2",ie,[o("span",null,[p(i(e.__("Attendance Sheet of"))+" ",1),o("b",de,i(n.getMonthName(t.selected_month))+" "+i(t.selected_year),1)]),o("span",null,i(e.__("Attendance Sheet")),1)]),a(g,{onClick:r[5]||(r[5]=s=>n.showExportModal()),loading:!1,type:"button",class:"text-white bg-blue-500 dark:bg-blue-500 hover:bg-blue-500 active:bg-blue-600 dark:active:bg-blue-600 focus:border-blue-600 dark:focus:border-blue-600 focus:ring focus:ring-blue-300 dark:focus:ring-blue-300 mr-6"},{default:d(()=>[p(i(e.__("Export")),1)]),_:1})]),ce,o("div",ue,[n.daysInMonth&&t.selected_month&&t.selected_year?(_(!0),y(U,{key:0},P(n.daysInMonth,(s,h)=>{var v;return _(),y("div",{key:h},[o("div",{class:T(["flex flex-col items-center pb-10 w-full max-w-sm border border-gray-200 rounded-lg shadow-md dark:border-gray-700 dark:text-black",n.attendanceStatus(s,l.attendances[h])=="present"?"bg-green-200 dark:bg-green-200":n.attendanceStatus(s,l.attendances[h])=="absent"?"bg-red-200 dark:bg-red-200":n.attendanceStatus(s,l.attendances[h])=="late"?"bg-yellow-200 dark:bg-yellow-200":"bg-gray-200 dark:bg-gray-200"])},[o("h5",me,i(s),1),o("span",fe,i((v=n.attendanceStatus(s,l.attendances[h+1]))!=null?v:"Not Entry"),1)],2)])}),128)):R("",!0)])])])):(_(),y("div",pe,[he,o("h3",_e,[a(V,{asShow:"div"})]),o("p",be,i(e.__("Please choose the month, student, class, and subject")),1)]))]),a(Y,{show:t.visible,onClose:r[10]||(r[10]=s=>t.visible=!1)},{title:d(()=>[p(i(e.__("Export Data")),1)]),content:d(()=>[o("div",ge,[o("div",ye,[k(o("input",{value:"xlsx",id:"excel","onUpdate:modelValue":r[6]||(r[6]=s=>t.export_data.type=s),type:"radio",name:"export_type",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[w,t.export_data.type]]),a(f,{for:"excel",class:"py-3 ml-2 cursor-pointer w-full text-sm font-medium text-gray-900 dark:text-gray-300",value:"Excel",required:!1})]),o("label",xe,[k(o("input",{value:"pdf",id:"pdf","onUpdate:modelValue":r[7]||(r[7]=s=>t.export_data.type=s),type:"radio",name:"export_type",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[w,t.export_data.type]]),a(f,{for:"pdf",class:"py-3 ml-2 w-full text-sm font-medium cursor-pointer text-gray-900 dark:text-gray-300",value:"PDF",required:!1})])])]),footer:d(()=>[a(g,{loading:!1,onClick:r[8]||(r[8]=s=>t.visible=!1),type:"button",theme:"outline-danger"},{default:d(()=>[p(i(e.__("Cancel")),1)]),_:1}),a(g,{onClick:r[9]||(r[9]=s=>n.exportSubmit()),loading:t.loading,type:"button",class:"mr-2"},{default:d(()=>[p(i(e.__("Export")),1)]),_:1},8,["loading"])]),_:1},8,["show"])]),_:1},8,["title"])}const qe=I(Q,[["render",ve]]);export{qe as default};
