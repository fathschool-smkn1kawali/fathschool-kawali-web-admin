import{_ as M}from"./AppLayout.68aece36.js";import{T as B,S as H}from"./Student.b56361e6.js";import{_ as L,u as O,I as p,o as E,c as W,w as i,a as s,b as a,g as h,t as c,C as F,n as _,v,V as k,r as n,S as R,U as q}from"./app.e2158f44.js";import{s as I}from"./multiselect.576f90b9.js";/* empty css                */import{_ as N}from"./Modal.a50958a8.js";import"./TopBarMenu.2e81788b.js";import"./CheckCircleIcon.7023e821.js";import"./XMarkIcon.e1cec856.js";import"./WarningToast.efaf1557.js";import"./PlusCircleIcon.b7e1c640.js";import"./UserIcon.81d1f1d5.js";import"./Bars3Icon.e96342cc.js";const D={components:{AppLayout:M,TeacherComponent:B,Student:H,Multiselect:I,CustomModal:N},props:{routine:Object,errors:Object,teachers:Object,courses:Object,subjects:Object,workdays:Object},data(){return{options3:[],form:O({teacher:this.routine?this.routine.teacher_id:null,class:this.routine?this.routine.course_id:null,subject:this.routine?this.routine.subject_id:null,time:[this.routine?p(this.routine.start_time,"HH:mm"):null,this.routine?p(this.routine.end_time,"HH:mm"):null],start_time:null,end_time:null,event:"only_me",weekday:this.routine?this.routine.weekday:null,_method:this.routine?"PUT":"POST"}),subjects_all:[],courses_all:[],teacher:[],eventEditModal:!1}},watch:{"form.class":{deep:!0,handler(e){this.loadSubjects()}},"form.teacher":{deep:!0,handler(e,t){this.form.class="";const l=this.teachers.find(b=>b.id===e);this.loadTeacherWiseCourses(l==null?void 0:l.courses)}}},mounted(){if(this.routine&&this.loadSubjects(),this.routine){const e=this.teachers.find(t=>t.id===this.routine.teacher_id);this.loadTeacherWiseCourses(e==null?void 0:e.courses)}},created(){for(const[e,t]of Object.entries(this.workdays))this.options3.push({value:e,label:t})},methods:{submitData(){},async submit(){if(this.form.weekday||alert("Please select weekday!"),(await axios.post(route("checkweekend",this.form.weekday))).data){alert("You cannot create a routine on a weekend day.");return}this.routine&&this.routine.is_recurring?this.eventEditModal=!0:this.submitForm()},submitForm(){this.form.start_time=p(this.form.time[0]).format("H:m"),this.form.end_time=p(this.form.time[1]).format("H:m"),this.routine?this.form.post(this.route("routine.update",this.routine.id),{preserveScroll:!0,onSuccess:()=>{this.form.reset("teacher","class","subject","time","start_time","end_time","weekday")}}):this.form.post(this.route("routine.store"),{preserveScroll:!0,onSuccess:()=>{this.form.reset("teacher","class","subject","time","start_time","end_time","weekday")}})},async loadSubjects(){this.subjects_all=[];let e=this.form.class,t=this.form.teacher;this.subjects.forEach(l=>{l.course_id==e&&l.teacher_id==t&&this.subjects_all.push(l)}),this.routine&&(this.subject=this.routine.subject_id)},async loadTeacherWiseCourses(e){this.courses_all=this.courses.filter(t=>e.includes(t.id))},async loadTeacher(){let e=this.form.subject,t=await axios.get(route("fetch.teachers",e));t.data?(this.teacher.id=t.data.teacher.id,this.teacher.name=t.data.teacher.name):this.errors.teacher="No Teacher is assigned for this course."}}},w=e=>(R("data-v-aea8dd87"),e=e(),q(),e),x={class:"pb-12"},A={class:"rounded-lg"},P={class:"grid sm:grid-cols-1 md:grid-cols-2 sm:gap-1 md:gap-4"},z={class:"w-full bg-white rounded-lg border border-gray-200 p-4 dark:bg-gray-800 dark:border-gray-700"},Y={class:"mb-3"},G={class:"mb-3"},J={class:"mb-3"},K={class:"w-full bg-white rounded-lg border border-gray-200 p-4 dark:bg-gray-800 dark:border-gray-700"},Q={class:"mb-3"},X={class:"mb-3"},Z={class:"text-left"},$={class:"font-bold mb-2 mt-8"},ee={class:"flex items-center mb-2"},te=w(()=>a("label",{for:"only_m1e",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This event ",-1)),re={class:"flex items-center mb-2"},se=w(()=>a("label",{for:"all_events1",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This and following events ",-1));function oe(e,t,l,b,o,g){const y=n("BreadcrumbLink"),j=n("Breadcrumb"),f=n("global-button"),S=n("Link"),T=n("page-header"),d=n("global-label"),m=n("Multiselect"),u=n("input-error"),V=n("a-range-picker"),C=n("custom-modal"),U=n("AppLayout");return E(),W(U,{title:e.__(l.routine?"Update routine":"Create Routine")},{default:i(()=>[s(j,null,{default:i(()=>[s(y,{href:e.route("routine.index"),title:"Class Schedule"},null,8,["href"]),s(y,{title:l.routine?e.__("Update Routine"):e.__("Create Routine")},null,8,["title"])]),_:1}),a("div",x,[s(T,null,{content:i(()=>[s(S,{"preserve-scroll":"",href:e.route("routine.index")},{default:i(()=>[s(f,{loading:!1,type:"button",theme:"primary"},{default:i(()=>[h(c(e.__("Back To List")),1)]),_:1})]),_:1},8,["href"])]),default:i(()=>[h(c(e.__(l.routine?"Update Routine":"Create a New Schedule"))+" ",1)]),_:1}),a("div",A,[a("form",{class:"mt-2",onSubmit:t[5]||(t[5]=F(r=>g.submit(),["prevent"]))},[a("div",P,[a("div",z,[a("div",Y,[s(d,{for:"teacher",value:"Select Teacher",required:!0}),s(m,{id:"teacher",class:"dark:text-gray-900",modelValue:o.form.teacher,"onUpdate:modelValue":t[0]||(t[0]=r=>o.form.teacher=r),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a teacher",options:l.teachers.map(r=>({value:r.id,label:r.name})),autocomplete:"off"},null,8,["modelValue","options"]),s(u,{error:e.$page.props.errors.teacher},null,8,["error"])]),a("div",G,[s(d,{for:"class",value:"Select Course",required:!0}),s(m,{id:"class",class:_(["dark:text-gray-900",e.$page.props.errors.class?"border-custom ":""]),modelValue:o.form.class,"onUpdate:modelValue":t[1]||(t[1]=r=>o.form.class=r),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a course",options:o.courses_all.map(r=>({value:r.id,label:r.name})),autocomplete:"off"},null,8,["class","modelValue","options"]),s(u,{error:e.$page.props.errors.class},null,8,["error"])]),a("div",J,[s(d,{for:"subject",value:"Select Subject",required:!0}),s(m,{id:"subject",class:_(["dark:text-gray-900",e.$page.props.errors.subject?"border-custom ":""]),modelValue:o.form.subject,"onUpdate:modelValue":t[2]||(t[2]=r=>o.form.subject=r),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a subject",options:o.subjects_all.map(r=>({value:r.subject_id,label:r.name})),autocomplete:"off"},null,8,["class","modelValue","options"]),s(u,{error:e.$page.props.errors.subject},null,8,["error"])])]),a("div",K,[a("div",Q,[s(d,{for:"weekday",value:e.__("Select Weekdays"),required:!0},null,8,["value"]),s(m,{id:"weekday",class:"dark:text-gray-900",modelValue:o.form.weekday,"onUpdate:modelValue":t[3]||(t[3]=r=>o.form.weekday=r),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Weekdays"),options:o.options3,autocomplete:"off"},null,8,["modelValue","placeholder","options"]),s(u,{error:e.$page.props.errors.weekday},null,8,["error"])]),a("div",X,[s(d,{for:"time",value:e.__("Schedule Time"),required:!0},null,8,["value"]),s(V,{picker:"time",style:{},class:_([e.$page.props.errors.time?"border-custom":"","custom-input dark:bg-gray-700 dark:border-gray-700 dark:text-gray-400"]),name:"time",id:"testTime","disabled-date":e.disabledDate,placeholder:["Start Time","End Time"],"disabled-time":e.disabledRangeTime,value:o.form.time,"onUpdate:value":t[4]||(t[4]=r=>o.form.time=r),format:"HH:mm"},null,8,["class","disabled-date","disabled-time","value"]),s(u,{error:e.$page.props.errors.time},null,8,["error"])])])]),s(f,{loading:o.form.processing,type:"submit",cssClass:"w-full mt-3",theme:"primary"},{default:i(()=>[h(c(e.__("Save")),1)]),_:1},8,["loading"])],32)])]),s(C,{show:o.eventEditModal,onClose:t[9]||(t[9]=r=>o.eventEditModal=!1)},{title:i(()=>[a("div",Z,c(e.__("Edit event")),1)]),content:i(()=>[a("div",$,[a("div",ee,[v(a("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>o.form.event=r),name:"event",id:"only_m1e",type:"radio",value:"only_me",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,o.form.event]]),te]),a("div",re,[v(a("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>o.form.event=r),name:"event",id:"all_events1",type:"radio",value:"all_events",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,o.form.event]]),se])])]),footer:i(()=>[s(f,{loading:o.form.processing,onClick:t[8]||(t[8]=r=>g.submitForm()),class:"mr-2"},{default:i(()=>[h(c(e.__("Update")),1)]),_:1},8,["loading"])]),_:1},8,["show"])]),_:1},8,["title"])}const ge=L(D,[["render",oe],["__scopeId","data-v-aea8dd87"]]);export{ge as default};
