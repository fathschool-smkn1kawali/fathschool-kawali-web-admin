import{C as w}from"./auto.4bbfcea2.js";import{_ as N}from"./AppLayout.770f3a27.js";import{_ as I,a9 as E,aa as M,N as R,u as U,f as V,Z as C,o as r,c as q,w as _,g as d,t as s,a as h,b as e,C as K,s as A,a3 as L,e as n,i as y,F as c,r as u,j as S,V as P,W as X}from"./app.0a62d3b4.js";import{_ as z}from"./Modal.44ca4dea.js";import"./TopBarMenu.e7daab03.js";import"./CheckCircleIcon.1814ecfe.js";import"./shepherd.esm.dbe9c7a3.js";import"./XMarkIcon.7c18cf19.js";import"./WarningToast.122671e2.js";import"./NavLink.c2694d47.js";import"./PlusCircleIcon.48513466.js";import"./UserIcon.fbaec5d8.js";import"./Bars3Icon.f5cb8044.js";const W={components:{AppLayout:N,Breadcrumb:E,BreadcrumbLink:M,NothingFound:R,ExportModal:z},props:{attendanceteacher:{type:Array,required:!0},absentTeachers:{type:Array,required:!0},filter_data:Object,study_programs:Object,attendance_percentage:Object,absence_percentage:Object},data(){var t;return{loading:!1,options:[],options2:[],export_options:[],visible:!1,export_visible:!1,show_user:"",export_data:U({type:"Excel",study_program:"all"}),filter:{name:"",month:"",study_program:(t=this.filter_data.study_program)!=null?t:null}}},mounted(){const t=document.getElementById("attendanceChart"),o={datasets:[{label:"Attendance",data:[this.attendance_percentage,this.absence_percentage],backgroundColor:["rgb(54, 162, 235)","rgb(255, 99, 132)"],hoverOffset:4}]};new w(t,{type:"doughnut",data:o,options:{responsive:!0,maintainAspectRatio:!1}});const l=document.getElementById("absenceChart"),i={datasets:[{label:"Absence",data:[this.absence_percentage,this.attendance_percentage],backgroundColor:["rgb(255, 99, 132)","rgb(54, 162, 235)"],hoverOffset:4}]};new w(l,{type:"doughnut",data:i,options:{responsive:!0,maintainAspectRatio:!1}})},created(){this.options.push({value:"",label:"All"});for(const[t,o]of Object.entries(this.study_programs))this.options.push({value:o.slug,label:o.name})},setup(t){return{attendanceteacher:V(t.attendanceteacher)}},computed:{filteredAttendance(){return this.attendanceteacher.filter(t=>{let o=!0,l=!0;return this.filter.name.trim()!==""&&(o=t.user.name.toLowerCase().includes(this.filter.name.trim().toLowerCase())),this.filter.month!==""&&(l=new Date(t.date).toISOString().slice(0,7)===this.filter.month),o&&l})},filteredAbsent(){return this.absentTeachers.filter(o=>{let l=!0,i=!0;return this.filter.name.trim()!==""&&(l=o.user_name.toLowerCase().includes(this.filter.name.trim().toLowerCase())),this.filter.month!==""&&(i=new Date(o.date).toISOString().slice(0,7)===this.filter.month),l&&i})}},methods:{filterData(){if(this.loading=!0,this.filter.name.trim()!==""&&(this.filter.name=this.filter.name.trim().toLowerCase()),this.filter.month!==""){const t=this.filter.month;this.filter.month=t}this.$inertia.get(this.route("teacher.attendance"),this.filter,{preserveScroll:!0,onFinish:t=>{this.loading=!1,this.attendanceteacher=t.props.attendance,this.absentTeachers=t.props.absentStudents}})},exportAttendance(){this.loading=!0;let t={};this.filter.name.trim()!==""&&(t.name=this.filter.name.trim()),this.filter.month!==""&&(t.month=this.filter.month),this.filter.course&&this.filter.course.trim()!==""&&(t.course=this.filter.course.trim()),this.filter.study_program&&this.filter.study_program.trim()!==""&&(t.study_program=this.filter.study_program.trim()),C({url:this.route("teacherattendance.export"),method:"POST",data:{...this.export_data,...t},headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},responseType:"blob"}).then(o=>{this.export_data.type;var l=window.URL.createObjectURL(new Blob([o.data])),i=document.createElement("a");i.href=l,i.setAttribute("download","studentattendance-report.xlsx"),document.body.appendChild(i),i.click(),this.loading=!1,this.visible=!1}).catch(o=>{this.loading=!1,this.visible=!1})},exportAbsent(){this.loading=!0;let t={};this.filter.name.trim()!==""&&(t.name=this.filter.name.trim()),this.filter.month!==""&&(t.month=this.filter.month),this.filter.course&&this.filter.course.trim()!==""&&(t.course=this.filter.course.trim()),this.filter.study_program&&this.filter.study_program.trim()!==""&&(t.study_program=this.filter.study_program.trim()),C({url:this.route("teacherabsent.export"),method:"POST",data:{...this.export_data,...t},headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},responseType:"blob"}).then(o=>{this.export_data.type;var l=window.URL.createObjectURL(new Blob([o.data])),i=document.createElement("a");i.href=l,i.setAttribute("download","teacherabsent-report.xlsx"),document.body.appendChild(i),i.click(),this.loading=!1,this.visible=!1}).catch(o=>{this.loading=!1,this.visible=!1})}}},b=t=>(P("data-v-f12ddec9"),t=t(),X(),t),Z={class:"mb-4"},G={class:"flex items-center"},H={for:"month",class:"ml-4 mr-2"},J={type:"submit",class:"ml-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},Q={class:"grid grid-cols-1 gap-6 xl:grid-cols-3 items-start mb-6"},Y={class:"flex flex-col gap-4 rounded-lg bg-white overflow-x-auto dark:bg-gray-800 p-6"},$={class:"flex flex-col items-center justify-center w-full h-64 mb-5"},tt=b(()=>e("canvas",{id:"attendanceChart",class:"mb-4 h-full"},null,-1)),et={class:"text-center text-lg font-bold text-sky-500"},st={class:"flex flex-col items-center justify-center w-full h-64"},at=b(()=>e("canvas",{id:"absenceChart",class:"mb-4 h-full"},null,-1)),ot={class:"text-center text-lg font-bold text-rose-400"},rt={class:"xl:col-span-2 bg-white dark:bg-gray-800 rounded-lg"},nt={class:"flex justify-between px-6 items-center pt-6 text-gray-900 dark:text-gray-400 text-base font-bold mb-2"},it={class:"ml-auto"},lt={class:"overflow-x-auto overflow-y-auto max-h-[400px]"},dt={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},ct={class:"text-xs text-gray-500 uppercase"},ht={scope:"col",class:"py-3 px-6"},pt={scope:"col",class:"py-3 px-6"},_t={scope:"col",class:"py-3 px-6"},ut={scope:"col",class:"py-3 px-6"},mt={scope:"col",class:"py-3 px-6"},ft={scope:"col",class:"py-3 px-6"},yt={scope:"col",class:"py-3 px-6"},gt={scope:"col",class:"py-3 px-6"},bt={class:"py-4 px-5 text-gray-900 dark:text-white"},xt={class:"py-4 px-5 text-gray-900 dark:text-white"},vt={key:0,class:"font-bold"},kt={class:"py-4 px-5 text-gray-900 dark:text-white"},wt={class:"py-4 px-5 text-gray-900 dark:text-white"},Ct={class:"py-4 px-5 text-gray-900 dark:text-white"},At={class:"py-4 px-5 text-gray-900 dark:text-white"},Lt={class:"py-4 px-5 text-gray-900 dark:text-white"},St={class:"py-4 px-5 text-gray-900 dark:text-white"},Tt={key:1},Ot={colspan:"9",class:"text-center p-4"},Bt={class:"xl:col-span-2 bg-white dark:bg-gray-800 rounded-lg"},Dt={class:"flex justify-between items-center px-6 py-4"},jt={class:"text-gray-900 dark:text-gray-400 text-lg font-bold"},Ft={class:"py-4 px-5"},Nt={class:"py-4 px-5"},It={class:"py-4 px-5"},Et={class:"py-4 px-5"},Mt={class:"py-4 px-5"},Rt={class:"py-4 px-5 text-gray-900 dark:text-white"},Ut={class:"py-4 px-5 text-gray-900 dark:text-white"},Vt={key:0,class:"font-bold"},qt={class:"py-4 px-5 text-gray-900 dark:text-white"},Kt={class:"py-4 px-5 text-gray-900 dark:text-white"},Pt={key:0,class:"flex flex-wrap items-center gap-0.5"},Xt={class:"py-4 px-5 text-gray-900 dark:text-white"},zt={key:0,class:"flex flex-wrap items-center gap-0.5"},Wt={key:1},Zt={colspan:"9",class:"text-center p-4"},Gt=b(()=>e("div",{class:"flex justify-center"},null,-1));function Ht(t,o,l,i,p,f){const T=u("BreadcrumbLink"),O=u("Breadcrumb"),B=u("page-header"),D=u("a-select"),x=u("global-button"),v=u("NothingFound"),j=u("global-table"),F=u("AppLayout");return r(),q(F,{title:t.__("Teacher Attendance")},{header:_(()=>[d(s(t.__("Teacher Attendance")),1)]),default:_(()=>[h(O,null,{default:_(()=>[h(T,{title:t.__("Teacher Attendance"),href:t.route("teacher.class")},null,8,["title","href"])]),_:1}),e("div",null,[h(B,{class:"flex-col sm:flex-row"},{default:_(()=>[d(s(t.__("Teacher Attendance")),1)]),_:1}),e("div",Z,[e("form",{onSubmit:o[3]||(o[3]=K((...a)=>f.filterData&&f.filterData(...a),["prevent"]))},[e("div",G,[A(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>p.filter.name=a),id:"name",placeholder:"Name",class:"p-2 border rounded"},null,512),[[L,p.filter.name]]),e("label",H,s(t.__("Date"))+":",1),A(e("input",{type:"date","onUpdate:modelValue":o[1]||(o[1]=a=>p.filter.month=a),id:"month",class:"p-2 border rounded mr-4"},null,512),[[L,p.filter.month]]),e("div",null,[h(D,{class:"width-100",size:"large",value:p.filter.study_program,"onUpdate:value":o[2]||(o[2]=a=>p.filter.study_program=a),"show-search":"",placeholder:t.__("Select a study program"),options:p.options,"filter-option":t.filterOption,onFocus:t.handleFocus,onBlur:t.handleBlur,onChange:t.handleChange},null,8,["value","placeholder","options","filter-option","onFocus","onBlur","onChange"])]),e("button",J,s(t.__("Filter")),1)])],32)]),e("div",Q,[e("div",Y,[e("div",$,[tt,e("div",et,s(l.attendance_percentage)+"% Kehadiran ",1)]),e("div",st,[at,e("div",ot,s(l.absence_percentage)+"% Ketidakhadiran ",1)])]),e("div",rt,[e("div",nt,[e("div",null,s(t.__("Attendance List")),1),e("div",it,[h(x,{loading:!1,onClick:o[4]||(o[4]=a=>f.exportAttendance()),type:"button",theme:"sky"},{default:_(()=>[d(s(t.__("Export")),1)]),_:1})])]),e("div",lt,[e("table",dt,[e("thead",ct,[e("tr",null,[e("th",ht,s(t.__("Name")),1),e("th",pt,s(t.__("Study Program")),1),e("th",_t,s(t.__("Date")),1),e("th",ut,s(t.__("Time In")),1),e("th",mt,s(t.__("Time Out")),1),e("th",ft,s(t.__("Lateness")),1),e("th",yt,s(t.__("Latlon In")),1),e("th",gt,s(t.__("Latlon Out")),1)])]),e("tbody",null,[i.attendanceteacher.length>0?(r(!0),n(c,{key:0},y(i.attendanceteacher,a=>(r(),n("tr",{key:a.id,class:"border-t dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",bt,s(a.user.name),1),e("td",xt,[a.user.department&&a.user.department.study_program?(r(),n("div",vt,s(a.user.department.study_program.name),1)):(r(),n(c,{key:1},[d(" - ")],64))]),e("td",kt,s(a.date),1),e("td",wt,s(a.time_in),1),e("td",Ct,s(a.time_out),1),e("td",At,s(a.lateness),1),e("td",Lt,s(a.latlon_in),1),e("td",St,s(a.latlon_out),1)]))),128)):(r(),n("tr",Tt,[e("td",Ot,[h(v,{asShow:"div"})])]))])])])])]),e("div",Bt,[e("div",Dt,[e("div",jt,s(t.__("Absent List")),1),h(x,{loading:!1,onClick:o[5]||(o[5]=a=>f.exportAbsent()),type:"button",theme:"sky"},{default:_(()=>[d(s(t.__("Export")),1)]),_:1})]),h(j,null,{head:_(()=>[e("th",Ft,s(t.__("Name")),1),e("th",Nt,s(t.__("Study Program")),1),e("th",It,s(t.__("Date")),1),e("th",Et,s(t.__("Leave Type")),1),e("th",Mt,s(t.__("Status")),1)]),body:_(()=>[l.absentTeachers.length>0?(r(!0),n(c,{key:0},y(l.absentTeachers,a=>(r(),n("tr",{key:a.id,class:"border-t dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",Rt,s(a.name),1),e("td",Ut,[a.department&&a.department.study_program?(r(),n("div",Vt,s(a.department.study_program.name),1)):(r(),n(c,{key:1},[d(" - ")],64))]),e("td",qt,s(a.date),1),e("td",Kt,[a.leaves.length>0?(r(),n("div",Pt,[(r(!0),n(c,null,y(a.leaves,(m,g)=>(r(),n("div",{key:m.id,class:"font-bold ml-0.5"},[d(s(m.type?m.type.name:"-")+" ",1),a.leaves.length!=g+1?(r(),n(c,{key:0},[d(",")],64)):S("",!0)]))),128))])):(r(),n(c,{key:1},[d(" - ")],64))]),e("td",Xt,[a.leaves.length>0?(r(),n("div",zt,[(r(!0),n(c,null,y(a.leaves,(m,g)=>{var k;return r(),n("div",{key:m.id,class:"font-bold ml-0.5"},[d(s((k=m.status)!=null?k:"-")+" ",1),a.leaves.length!=g+1?(r(),n(c,{key:0},[d(",")],64)):S("",!0)])}),128))])):(r(),n(c,{key:1},[d(" - ")],64))])]))),128)):(r(),n("tr",Wt,[e("td",Zt,[h(v,{asShow:"div"})])]))]),_:1})]),Gt])]),_:1},8,["title"])}const de=I(W,[["render",Ht],["__scopeId","data-v-f12ddec9"]]);export{de as default};
