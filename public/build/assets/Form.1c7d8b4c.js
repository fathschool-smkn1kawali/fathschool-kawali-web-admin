import{_ as M}from"./AppLayout.f7869522.js";import{T as W,S as B}from"./Student.488714e8.js";import{_ as H,u as L,I as p,o as O,c as E,w as i,a as r,b as a,g as h,t as m,C as q,n as _,s as y,V as k,r as n,S as F,U as R}from"./app.eb4bca63.js";import{s as I}from"./multiselect.bd328a4e.js";/* empty css                */import{_ as N}from"./Modal.d8e7dcb9.js";import"./TopBarMenu.57ba7e85.js";import"./CheckCircleIcon.c15b336b.js";import"./shepherd.esm.28e46ee4.js";import"./XMarkIcon.c835eea2.js";import"./WarningToast.ca887990.js";import"./NavLink.88c501bd.js";import"./PlusCircleIcon.b3c660e0.js";import"./UserIcon.11494925.js";import"./Bars3Icon.9d3eeab9.js";const A={components:{AppLayout:M,TeacherComponent:W,Student:B,Multiselect:I,CustomModal:N},props:{routine:Object,errors:Object,teachers:Object,courses:Object,subjects:Object,workdays:Object},data(){return{options3:[],form:L({teacher:this.routine?this.routine.teacher_id:null,class:this.routine?this.routine.course_id:null,subject:this.routine?this.routine.subject_id:null,time:[this.routine?p(this.routine.start_time,"HH:mm"):null,this.routine?p(this.routine.end_time,"HH:mm"):null],start_time:null,end_time:null,event:"only_me",weekday:this.routine?this.routine.weekday:null,activation:this.routine?this.routine.activation:null,_method:this.routine?"PUT":"POST"}),subjects_all:[],courses_all:[],teacher:[],eventEditModal:!1}},watch:{"form.class":{deep:!0,handler(e){this.loadSubjects()}},"form.teacher":{deep:!0,handler(e,t){this.form.class="";const l=this.teachers.find(b=>b.id===e);this.loadTeacherWiseCourses(l==null?void 0:l.courses)}}},mounted(){if(this.routine&&this.loadSubjects(),this.routine){const e=this.teachers.find(t=>t.id===this.routine.teacher_id);this.loadTeacherWiseCourses(e==null?void 0:e.courses)}},created(){for(const[e,t]of Object.entries(this.workdays))this.options3.push({value:e,label:t})},methods:{submitData(){},async submit(){if(this.form.weekday||alert("Please select weekday!"),(await axios.post(route("checkweekend",this.form.weekday))).data){alert("You cannot create a routine on a weekend day.");return}this.routine&&this.routine.is_recurring?this.eventEditModal=!0:this.submitForm()},submitForm(){this.form.start_time=p(this.form.time[0]).format("H:m"),this.form.end_time=p(this.form.time[1]).format("H:m"),this.routine?this.form.post(this.route("routine.update",this.routine.id),{preserveScroll:!0,onSuccess:()=>{this.form.reset("teacher","class","subject","time","start_time","end_time","weekday","activation")}}):this.form.post(this.route("routine.store"),{preserveScroll:!0,onSuccess:()=>{this.form.reset("teacher","class","subject","time","start_time","end_time","weekday","activation")}})},async loadSubjects(){this.subjects_all=[];let e=this.form.class,t=this.form.teacher;this.subjects.forEach(l=>{l.course_id==e&&l.teacher_id==t&&this.subjects_all.push(l)}),this.routine&&(this.subject=this.routine.subject_id)},async loadTeacherWiseCourses(e){this.courses_all=this.courses.filter(t=>e.includes(t.id))},async loadTeacher(){let e=this.form.subject,t=await axios.get(route("fetch.teachers",e));t.data?(this.teacher.id=t.data.teacher.id,this.teacher.name=t.data.teacher.name):this.errors.teacher="No Teacher is assigned for this course."}}},w=e=>(F("data-v-dcca6840"),e=e(),R(),e),D={class:"pb-12"},P={class:"rounded-lg"},x={class:"grid sm:grid-cols-1 md:grid-cols-2 sm:gap-1 md:gap-4"},z={class:"w-full bg-white rounded-lg border border-gray-200 p-4 dark:bg-gray-800 dark:border-gray-700"},Y={class:"mb-3"},G={class:"mb-3"},J={class:"mb-3"},K={class:"w-full bg-white rounded-lg border border-gray-200 p-4 dark:bg-gray-800 dark:border-gray-700"},Q={class:"mb-3"},X={class:"mb-3"},Z={class:"mb-3"},$={class:"text-left"},ee={class:"font-bold mb-2 mt-8"},te={class:"flex items-center mb-2"},oe=w(()=>a("label",{for:"only_m1e",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This event ",-1)),re={class:"flex items-center mb-2"},se=w(()=>a("label",{for:"all_events1",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This and following events ",-1));function ae(e,t,l,b,s,g){const v=n("BreadcrumbLink"),j=n("Breadcrumb"),f=n("global-button"),S=n("Link"),V=n("page-header"),u=n("global-label"),c=n("Multiselect"),d=n("input-error"),T=n("a-range-picker"),C=n("custom-modal"),U=n("AppLayout");return O(),E(U,{title:e.__(l.routine?"Update routine":"Create Routine")},{default:i(()=>[r(j,null,{default:i(()=>[r(v,{href:e.route("routine.index"),title:"Class Schedule"},null,8,["href"]),r(v,{title:l.routine?e.__("Update Routine"):e.__("Create Routine")},null,8,["title"])]),_:1}),a("div",D,[r(V,null,{content:i(()=>[r(S,{"preserve-scroll":"",href:e.route("routine.index")},{default:i(()=>[r(f,{loading:!1,type:"button",theme:"primary"},{default:i(()=>[h(m(e.__("Back To List")),1)]),_:1})]),_:1},8,["href"])]),default:i(()=>[h(m(e.__(l.routine?"Update Routine":"Create a New Schedule"))+" ",1)]),_:1}),a("div",P,[a("form",{class:"mt-2",onSubmit:t[6]||(t[6]=q(o=>g.submit(),["prevent"]))},[a("div",x,[a("div",z,[a("div",Y,[r(u,{for:"teacher",value:"Select Teacher",required:!0}),r(c,{id:"teacher",class:"dark:text-gray-900",modelValue:s.form.teacher,"onUpdate:modelValue":t[0]||(t[0]=o=>s.form.teacher=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a teacher",options:l.teachers.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","options"]),r(d,{error:e.$page.props.errors.teacher},null,8,["error"])]),a("div",G,[r(u,{for:"class",value:"Select Course",required:!0}),r(c,{id:"class",class:_(["dark:text-gray-900",e.$page.props.errors.class?"border-custom ":""]),modelValue:s.form.class,"onUpdate:modelValue":t[1]||(t[1]=o=>s.form.class=o),"close-on-select":!1,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a course",options:s.courses_all.map(o=>({value:o.course_id,label:o.name})),autocomplete:"off"},null,8,["class","modelValue","options"]),r(d,{error:e.$page.props.errors.class},null,8,["error"])]),a("div",J,[r(u,{for:"subject",value:"Select Subject",required:!0}),r(c,{id:"subject",class:_(["dark:text-gray-900",e.$page.props.errors.subject?"border-custom ":""]),modelValue:s.form.subject,"onUpdate:modelValue":t[2]||(t[2]=o=>s.form.subject=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:"Select a subject",options:s.subjects_all.map(o=>({value:o.subject_id,label:o.name})),autocomplete:"off"},null,8,["class","modelValue","options"]),r(d,{error:e.$page.props.errors.subject},null,8,["error"])])]),a("div",K,[a("div",Q,[r(u,{for:"activation",value:e.__("Weekdays Activation"),required:!0},null,8,["value"]),r(c,{id:"activation",class:"dark:text-gray-900",modelValue:s.form.activation,"onUpdate:modelValue":t[3]||(t[3]=o=>s.form.activation=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Weekdays"),options:s.options3,autocomplete:"off"},null,8,["modelValue","placeholder","options"]),r(d,{error:e.$page.props.errors.activation},null,8,["error"])]),a("div",X,[r(u,{for:"weekday",value:e.__("Select Weekdays"),required:!0},null,8,["value"]),r(c,{id:"weekday",class:"dark:text-gray-900",modelValue:s.form.weekday,"onUpdate:modelValue":t[4]||(t[4]=o=>s.form.weekday=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Weekdays"),options:s.options3,autocomplete:"off"},null,8,["modelValue","placeholder","options"]),r(d,{error:e.$page.props.errors.weekday},null,8,["error"])]),a("div",Z,[r(u,{for:"time",value:e.__("Schedule Time"),required:!0},null,8,["value"]),r(T,{picker:"time",style:{},class:_([e.$page.props.errors.time?"border-custom":"","custom-input dark:bg-gray-700 dark:border-gray-700 dark:text-gray-400"]),name:"time",id:"testTime","disabled-date":e.disabledDate,placeholder:["Start Time","End Time"],"disabled-time":e.disabledRangeTime,value:s.form.time,"onUpdate:value":t[5]||(t[5]=o=>s.form.time=o),format:"HH:mm"},null,8,["class","disabled-date","disabled-time","value"]),r(d,{error:e.$page.props.errors.time},null,8,["error"])])])]),r(f,{loading:s.form.processing,type:"submit",cssClass:"w-full mt-3",theme:"primary"},{default:i(()=>[h(m(e.__("Save")),1)]),_:1},8,["loading"])],32)])]),r(C,{show:s.eventEditModal,onClose:t[10]||(t[10]=o=>s.eventEditModal=!1)},{title:i(()=>[a("div",$,m(e.__("Edit event")),1)]),content:i(()=>[a("div",ee,[a("div",te,[y(a("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>s.form.event=o),name:"event",id:"only_m1e",type:"radio",value:"only_me",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,s.form.event]]),oe]),a("div",re,[y(a("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>s.form.event=o),name:"event",id:"all_events1",type:"radio",value:"all_events",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,s.form.event]]),se])])]),footer:i(()=>[r(f,{loading:s.form.processing,onClick:t[9]||(t[9]=o=>g.submitForm()),class:"mr-2"},{default:i(()=>[h(m(e.__("Update")),1)]),_:1},8,["loading"])]),_:1},8,["show"])]),_:1},8,["title"])}const ke=H(A,[["render",ae],["__scopeId","data-v-dcca6840"]]);export{ke as default};
