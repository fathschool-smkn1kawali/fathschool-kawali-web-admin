import{_ as I}from"./AppLayout.e446c98c.js";import{P as H}from"./Pagination.285ecdee.js";import{T as w}from"./ToolTip.ecacd31e.js";import{_ as A,u as D,I as m,o as x,c as S,w as a,a as l,b as s,g as c,t as d,C as k,j as O,s as g,X as b,r as n}from"./app.0fe294dc.js";import{F as B,m as P,a as L}from"./main.4779ef4e.js";import{m as R}from"./main.1685f572.js";import{m as N}from"./main.b5a562e4.js";import{s as W}from"./multiselect.0e5fdc61.js";/* empty css                */import{_ as G}from"./Modal.48c9f882.js";import{r as z}from"./TrashIcon.fe35b37b.js";import{r as X}from"./PencilSquareIcon.78c3e2b0.js";import{r as Y}from"./EyeIcon.5183fbb5.js";import"./TopBarMenu.658c6f16.js";import"./CheckCircleIcon.0b1b48c7.js";import"./shepherd.esm.1647f5c6.js";import"./XMarkIcon.b073216c.js";import"./WarningToast.9e91d17d.js";import"./NavLink.f87d79c3.js";import"./PlusCircleIcon.92b99d95.js";import"./UserIcon.56a47257.js";import"./Bars3Icon.8ccbdb06.js";const J={components:{AppLayout:I,ToolTip:w,Pagination:H,TrashIcon:z,PencilSquareIcon:X,EyeIcon:Y,ToolTip:w,CustomModal:G,FullCalendar:B,Multiselect:W},props:{routines:Object,schedules:Array,classes:Array,teachers:Array,query:Object},data(){var t,e,i;return{modal_show:!1,loading:!1,eventDetailModal:!1,eventDeleteModal:!1,eventDrugModal:!1,filter:D({course_id:(t=this.query.course_id)!=null?t:"",subject_id:(e=this.query.subject_id)!=null?e:"",teacher_id:(i=this.query.teacher_id)!=null?i:""}),calendarOptions:{locale:this.$page.props.locale,plugins:[P,L,R,N],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},buttonText:{prev:this.__("prev"),next:this.__("next"),today:this.__("today"),month:this.__("month"),week:this.__("week"),day:this.__("day"),list:this.__("list")},height:800,selectable:!0,editable:!0,initialView:"timeGridWeek",events:this.schedules,eventContent:function(v){return{html:v.event.title.replace(/<br>/g,"<br>")}},dateClick:this.dateClick,eventClick:this.eventClick,select:this.selectEvent,eventDrop:this.eventDropped,eventResize:this.eventResized},form:this.$inertia.form({id:"",weekname:"",weekday:"",start_time:"",end_time:"",class:"",teacher:"",subject:"",type:"",event:"only_me"}),subjects:[],filter_subjects:[],showEvent:null,draggedEvent:null,eventDeleteForm:D({id:null,event:"only_me"})}},watch:{notices:{deep:!0,handler(t,e){this.notices.forEach(i=>{this.notice.id==i.id&&(this.notice=i)})}},"form.class":{deep:!0,handler(t){this.loadSubjects("modal")}},"filter.course_id":{deep:!0,handler(t){this.loadSubjects("filter")}},eventDrugModal:{deep:!0,handler(t){t||this.draggedEvent!=null&&this.draggedEvent.revert()}}},methods:{async refreshSchedule(){let t=await axios.get(route("routine.refresh"));this.schedules=t.data,this.calendarOptions.events=t.data},async selectEvent(t){this.loading=!1,this.form.reset();let e=t.startStr,i=t.endStr;if(this.form.weekday=m(e).format("d"),this.form.weekname=m(e).format("dddd"),this.form.start_time=m(e).format("HH:mm:ss"),this.form.end_time=m(i).format("HH:mm:ss"),this.form.type="api",(await axios.post(route("checkweekend",this.form.weekday))).data){alert("You cannot create a routine on a weekend day.");return}this.loading=!1,this.modal_show=!0},async eventDropped(t){t.event.extendedProps.is_recurring?(this.draggedEvent=t,this.eventDrugModal=!0):(this.form.event="all_events",this.draggedEvent=t,this.eventDroppedUpdate())},async eventDroppedUpdate(){let e=this.draggedEvent.event,i=e.startStr,v=e.endStr,r=await axios.get(route("routine.details",e.id));this.form.id=e.id,this.form.weekday=m(i).format("d"),this.form.start_time=m(i).format("HH:mm:ss"),this.form.end_time=m(v).format("HH:mm:ss"),this.form.class=r.data.course_id,this.form.teacher=r.data.teacher_id,this.form.subject=r.data.subject_id,this.form.type="api",this.updateData(),this.draggedEvent=null,this.eventDrugModal=!1},async eventResized(t){t.event.extendedProps.is_recurring?(this.draggedEvent=t,this.eventDrugModal=!0):(this.form.event="all_events",this.draggedEvent=t,this.eventDroppedUpdate())},async updateData(){await axios.put(route("routine.update",this.form.id),this.form),this.form.reset()},async saveData(){this.loading=!0,this.form.id?this.form.put(this.route("routine.update",this.form.id),{preserveScroll:!0,onSuccess:()=>{this.loading=!1,this.modal_show=!1,this.form.reset(),window.location.reload()},onError:()=>{this.loading=!1}}):this.form.post(this.route("routine.store"),{preserveScroll:!0,onSuccess:()=>{this.loading=!1,this.modal_show=!1,this.form.reset(),window.location.reload()},onError:()=>{this.loading=!1}})},async eventClick(t){this.showEvent=t.event._def,console.log(t.event._def),this.eventDetailModal=!0},eventEdit(){this.$inertia.get(this.route("routine.edit",this.showEvent.publicId))},eventDeleteModalOpen(){this.showEvent.extendedProps.is_recurring?(this.eventDeleteForm.id=this.showEvent.publicId,this.eventDeleteModal=!0):(this.eventDeleteForm.id=this.showEvent.publicId,this.eventDeleteForm.event="all_events",this.eventDelete())},eventDelete(){return confirm("Are you sure ?")==!0&&this.eventDeleteForm.post(this.route("routine.delete"),{preserveScroll:!0,onSuccess:t=>{this.calendarOptions.events=this.schedules,this.eventDeleteForm.reset(),this.eventDeleteModal=!1,this.eventDetailModal=!1}}),!1},filterData(){this.filter.get(this.route("routine.index"),{preserveScroll:!0})},async loadSubjects(t){let e=t=="modal"?this.form.class:this.filter.course_id,i=await axios.get(route("fetch.subjects",e));t=="modal"?(this.subjects=[],this.subjects=i.data):(this.filter_subjects=[],this.filter_subjects=i.data)},filterData(){this.filter.get(this.route("routine.index"),{preserveScroll:!0})}},mounted(){this.loadSubjects("filter")}},K={class:"rounded-lg mb-4 py-4 px-6 text-lg font-semibold text-left text-gray-900 bg-white dark:text-white dark:bg-gray-800"},Q={class:"text-lg dark:text-white"},Z={class:"mt-0.5"},$={class:"mt-0.5"},ee={class:"mt-0.5"},te={class:"col-span-2 bg-white overflow-x-auto rounded-lg dark:bg-gray-800 p-6"},oe={class:"p-6 dark:text-gray-400"},re={class:"w-full"},se={class:"w-full p-4 dark:bg-gray-800 dark:border-gray-700 rounded-lg"},le={class:"mb-3"},ae=["value"],ie={class:"mb-3"},ne=["value"],de={class:"mb-3"},ue={class:"mb-3"},ce={class:"mb-3"},me={class:"flex justify-between gap-4"},fe=s("div",{class:"text-left"},null,-1),he=["innerHTML"],pe={class:"text-left"},ve={class:"font-bold mb-2 mt-8"},ge={class:"flex items-center mb-2"},be=s("label",{for:"only_me",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This event ",-1),_e={class:"flex items-center mb-2"},ye=s("label",{for:"all_events",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This and following events ",-1),ke={class:"text-left"},we={class:"font-bold mb-2 mt-8"},De={class:"flex items-center mb-2"},xe=s("label",{for:"only_m1e",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This event ",-1),Se={class:"flex items-center mb-2"},je=s("label",{for:"all_events1",class:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," This and following events ",-1);function Ce(t,e,i,v,r,f){const j=n("BreadcrumbLink"),C=n("Breadcrumb"),h=n("global-button"),M=n("page-header"),u=n("global-label"),p=n("Multiselect"),V=n("FullCalendar"),E=n("a-button"),_=n("input-error"),T=n("a-modal"),F=n("PencilSquareIcon"),U=n("TrashIcon"),y=n("custom-modal"),q=n("AppLayout");return x(),S(q,{title:t.__("Class Schedule")},{default:a(()=>[l(C,null,{default:a(()=>[l(j,{title:t.__("Class Schedule")},null,8,["title"])]),_:1}),s("div",null,[l(M,{class:"flex items-center justify-between"},{content:a(()=>[l(h,{loading:!1,type:"link",url:t.route("routine.create"),theme:"primary"},{default:a(()=>[c(d(t.__("Add New")),1)]),_:1},8,["url"])]),default:a(()=>[c(d(t.__("Class Schedule"))+" ",1)]),_:1}),s("div",K,[s("h1",Q,d(t.__("Filter By")),1),s("form",{class:"grid items-end grid-cols-1 xl:grid-cols-4 gap-[18px]",onSubmit:e[3]||(e[3]=k(o=>f.filterData(),["prevent"]))},[s("div",Z,[l(u,{for:"name",value:"Select Course",required:!1}),l(p,{id:"class",class:"dark:text-gray-900",modelValue:r.filter.course_id,"onUpdate:modelValue":e[0]||(e[0]=o=>r.filter.course_id=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Course"),options:i.classes.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",$,[l(u,{for:"name",value:"Select Subject",required:!1}),l(p,{id:"subject",class:"dark:text-gray-900",modelValue:r.filter.subject_id,"onUpdate:modelValue":e[1]||(e[1]=o=>r.filter.subject_id=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Subject"),options:r.filter_subjects.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",ee,[l(u,{for:"name",value:"Select Teacher",required:!1}),l(p,{id:"teacher",class:"dark:text-gray-900",modelValue:r.filter.teacher_id,"onUpdate:modelValue":e[2]||(e[2]=o=>r.filter.teacher_id=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Teacher"),options:i.teachers.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",null,[l(h,{loading:r.filter.processing,type:"submit",theme:"primary"},{default:a(()=>[c(d(t.__("Apply Filter")),1)]),_:1},8,["loading"])])],32)]),s("div",te,[l(V,{options:r.calendarOptions,class:"min-w-[991px]"},null,8,["options"])])]),l(T,{visible:r.modal_show,"onUpdate:visible":e[8]||(e[8]=o=>r.modal_show=o),title:this.form.id?"Update Routine Schedule":"Create Routine Schedule",onOk:e[9]||(e[9]=o=>r.modal_show=!1)},{footer:a(()=>[l(E,{key:"back",onClick:e[4]||(e[4]=o=>r.modal_show=!1)},{default:a(()=>[c("Close")]),_:1})]),default:a(()=>[s("div",oe,[s("div",re,[s("div",se,[s("div",le,[l(u,{for:"class",value:"Select Weekdays"}),s("input",{value:r.form.weekname,type:"text",class:"pl-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,8,ae)]),s("div",ie,[l(u,{for:"class",value:"Schedule Time"}),s("input",{value:r.form.start_time+" - "+r.form.end_time,type:"text",class:"pl-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,8,ne)]),s("div",de,[l(u,{for:"teacher",value:"Teacher",required:!0}),l(p,{id:"teacher",class:"dark:text-gray-900",modelValue:r.form.teacher,"onUpdate:modelValue":e[5]||(e[5]=o=>r.form.teacher=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Teacher"),options:i.teachers.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"]),l(_,{error:t.$page.props.errors.teacher},null,8,["error"])]),s("div",ue,[l(u,{for:"class",value:"Class",required:!0}),l(p,{id:"class",class:"dark:text-gray-900",modelValue:r.form.class,"onUpdate:modelValue":e[6]||(e[6]=o=>r.form.class=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Course"),options:i.classes.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"]),l(_,{error:t.$page.props.errors.class},null,8,["error"])]),s("div",ce,[l(u,{for:"subject",value:"Subject",required:!0}),l(p,{id:"subject",class:"dark:text-gray-900",modelValue:r.form.subject,"onUpdate:modelValue":e[7]||(e[7]=o=>r.form.subject=o),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:t.__("Select Subject"),options:r.subjects.map(o=>({value:o.id,label:o.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"]),l(_,{error:t.$page.props.errors.subject},null,8,["error"])]),s("div",me,[r.form.id?(x(),S(h,{key:0,loading:r.loading,type:"button",onClick:k(t.deleteData,["prevent"]),class:"text-white bg-red-500 dark:bg-red-500 hover:bg-red-500 active:bg-red-600 dark:active:bg-red-600 focus:border-red-600 dark:focus:border-red-600 focus:ring focus:ring-red-300 w-full mt-3 dark:focus:ring-red-300"},{default:a(()=>[c(d(t.__("Delete")),1)]),_:1},8,["loading","onClick"])):O("",!0),l(h,{loading:r.loading,type:"button",onClick:k(f.saveData,["prevent"]),class:"text-white bg-blue-500 dark:bg-blue-500 hover:bg-blue-500 active:bg-blue-600 dark:active:bg-blue-600 focus:border-blue-600 dark:focus:border-blue-600 focus:ring focus:ring-blue-300 w-full mt-3 dark:focus:ring-blue-300"},{default:a(()=>[c(d(t.__("Save")),1)]),_:1},8,["loading","onClick"])])])])])]),_:1},8,["visible","title"]),l(y,{show:r.eventDetailModal,onClose:e[12]||(e[12]=o=>r.eventDetailModal=!1)},{title:a(()=>[fe]),icon:a(()=>[s("div",{onClick:e[10]||(e[10]=o=>f.eventEdit()),class:"cursor-pointer"},[l(F,{class:"w-6 h-6 text-blue-500"})]),s("div",{onClick:e[11]||(e[11]=o=>f.eventDeleteModalOpen()),class:"cursor-pointer"},[l(U,{class:"w-6 h-6 text-pink-500"})])]),content:a(()=>{var o;return[s("div",{innerHTML:(o=r.showEvent)==null?void 0:o.title,class:"font-bold mb-2"},null,8,he)]}),_:1},8,["show"]),l(y,{show:r.eventDeleteModal,onClose:e[16]||(e[16]=o=>r.eventDeleteModal=!1)},{title:a(()=>[s("div",pe,d(t.__("Delete event")),1)]),content:a(()=>[s("div",ve,[s("div",ge,[g(s("input",{"onUpdate:modelValue":e[13]||(e[13]=o=>r.eventDeleteForm.event=o),name:"event",id:"only_me",type:"radio",value:"only_me",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[b,r.eventDeleteForm.event]]),be]),s("div",_e,[g(s("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>r.eventDeleteForm.event=o),name:"event",id:"all_events",type:"radio",value:"all_events",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[b,r.eventDeleteForm.event]]),ye])])]),footer:a(()=>[l(h,{onClick:e[15]||(e[15]=o=>f.eventDelete()),loading:r.eventDeleteForm.processing,type:"button",class:"mr-2"},{default:a(()=>[c(d(t.__("Delete")),1)]),_:1},8,["loading"])]),_:1},8,["show"]),l(y,{show:r.eventDrugModal,onClose:e[20]||(e[20]=o=>r.eventDrugModal=!1)},{title:a(()=>[s("div",ke,d(t.__("Drag event")),1)]),content:a(()=>[s("div",we,[s("div",De,[g(s("input",{"onUpdate:modelValue":e[17]||(e[17]=o=>r.form.event=o),name:"event",id:"only_m1e",type:"radio",value:"only_me",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[b,r.form.event]]),xe]),s("div",Se,[g(s("input",{"onUpdate:modelValue":e[18]||(e[18]=o=>r.form.event=o),name:"event",id:"all_events1",type:"radio",value:"all_events",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[b,r.form.event]]),je])])]),footer:a(()=>[l(h,{onClick:e[19]||(e[19]=o=>f.eventDroppedUpdate()),loading:r.eventDeleteForm.processing,type:"button",class:"mr-2"},{default:a(()=>[c(d(t.__("Update")),1)]),_:1},8,["loading"])]),_:1},8,["show"])]),_:1},8,["title"])}const Ke=A(J,[["render",Ce]]);export{Ke as default};
